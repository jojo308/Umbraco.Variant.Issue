{"version":3,"file":"anchor-tag-picker-DsqTlvZb.js","sources":["../../BackofficeExtensions/CustomAnchorEditor/src/property-editor/anchor-tag-picker.ts"],"sourcesContent":["import { LitElement, html, customElement, state, property } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbPropertyEditorUiElement } from \"@umbraco-cms/backoffice/extension-registry\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport AnchorsManagementContext, { ANCHORS_MANAGEMENT_CONTEXT_TOKEN } from \"../context/anchors.context\";\r\nimport { UmbPropertyEditorConfigCollection } from \"@umbraco-cms/backoffice/property-editor\";\r\nimport { UMB_ENTITY_WORKSPACE_CONTEXT, UMB_WORKSPACE_CONTEXT, UmbVariantableWorkspaceContextInterface, UmbVariantDatasetWorkspaceContext } from \"@umbraco-cms/backoffice/workspace\";\r\nimport { UMB_PROPERTY_CONTEXT, UMB_PROPERTY_DATASET_CONTEXT, UmbPropertyContext, UmbPropertyDatasetContext } from \"@umbraco-cms/backoffice/property\";\r\nimport { UMB_ENTITY_CONTEXT, UmbEntityContext } from \"@umbraco-cms/backoffice/entity\";\r\nimport { UMB_DOCUMENT_WORKSPACE_CONTEXT, UmbDocumentWorkspaceContext } from \"@umbraco-cms/backoffice/document\";\r\n\r\n@customElement('anchor-tag-picker')\r\nexport default class AnchorTagPicker extends UmbElementMixin((LitElement)) implements UmbPropertyEditorUiElement {\r\n\r\n    _anchorsContext?: AnchorsManagementContext;\r\n    _workspaceContext?: UmbVariantableWorkspaceContextInterface;\r\n    _propertyDatasetContext?: UmbPropertyDatasetContext;\r\n    _documentWorkspaceContext?: UmbDocumentWorkspaceContext;\r\n    _propertyContext?: UmbPropertyContext;\r\n    _entityContext?: UmbEntityContext;\r\n    _entityWorkspaceContext?: UmbVariantDatasetWorkspaceContext;\r\n\r\n    @property({ type: Object })\r\n    value?: unknown;\r\n\r\n    @property({ type: Object })\r\n    config?: UmbPropertyEditorConfigCollection | undefined;\r\n\r\n    @state()\r\n    _anchors?: Array<string> = [];\r\n\r\n    @state()\r\n    _nodeId?: string;\r\n\r\n    @state()\r\n    _culture?: string;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this._nodeId = '';\r\n        this._culture = '';\r\n\r\n        this.consumeContext(UMB_ENTITY_CONTEXT, (ctx) => {\r\n            this._entityContext = ctx;\r\n            this._nodeId = this._entityContext.getUnique() ?? '';\r\n            console.log('UMB_ENTITY_CONTEXT', ctx)\r\n        })\r\n\r\n        this.consumeContext(ANCHORS_MANAGEMENT_CONTEXT_TOKEN, (instance) => {\r\n            this._anchorsContext = instance\r\n\r\n            this.observe(instance.anchors, (anchors) => {\r\n                this._anchors = anchors;\r\n            });\r\n        })\r\n    }\r\n\r\n    #consumeContexts() {\r\n        this.consumeContext(UMB_WORKSPACE_CONTEXT, (ctx) => {\r\n            this._workspaceContext = (ctx as UmbVariantableWorkspaceContextInterface);\r\n            console.log('UMB_WORKSPACE_CONTEXT', ctx)\r\n\r\n            this.observe(this._workspaceContext.variantOptions, (options) => {\r\n                console.log('UMB_WORKSPACE_CONTEXT:variant options:', options)\r\n            })\r\n\r\n            this.observe(this._workspaceContext.variants, (variants) => {\r\n                console.log('UMB_WORKSPACE_CONTEXT:variants:', variants)\r\n            })\r\n        });\r\n\r\n        this.consumeContext(UMB_PROPERTY_DATASET_CONTEXT, (ctx) => {\r\n            this._propertyDatasetContext = ctx;\r\n            console.log('UMB_PROPERTY_DATASET_CONTEXT', ctx)\r\n            if (this._propertyDatasetContext.propertyVariantId) {\r\n                this._propertyDatasetContext.propertyVariantId('contentBlocks').then(x => {\r\n                    this.observe(x, (anchorLinks) => {\r\n                        console.log('UMB_PROPERTY_DATASET_CONTEXT:contentBlocks:', anchorLinks)\r\n                    })\r\n\r\n                })\r\n            }\r\n        })\r\n\r\n        this.consumeContext(UMB_DOCUMENT_WORKSPACE_CONTEXT, (ctx) => {\r\n            console.log('UMB_DOCUMENT_WORKSPACE_CONTEXT', ctx)\r\n            this._documentWorkspaceContext = ctx;\r\n        })\r\n\r\n        this.consumeContext(UMB_PROPERTY_CONTEXT, (ctx) => {\r\n            console.log('UMB_PROPERTY_CONTEXT', ctx)\r\n            this._propertyContext = ctx;\r\n\r\n            this.observe(this._propertyContext.variantId, (id) => {\r\n                console.log('UMB_PROPERTY_CONTEXT:variantId:', id)\r\n                if (id && id.culture !== undefined) {\r\n                    this._culture = id.culture ?? '';\r\n                    console.log(':UMB_PROPERTY_CONTEXTculture:', this._culture)\r\n                } else {\r\n                    console.log('UMB_PROPERTY_CONTEXT:culture is undefined')\r\n                }\r\n            })\r\n        })\r\n\r\n        this.consumeContext(UMB_ENTITY_WORKSPACE_CONTEXT, (ctx) => {\r\n            console.log('UMB_ENTITY_WORKSPACE_CONTEXT', ctx)\r\n            this._entityWorkspaceContext = (ctx as UmbVariantDatasetWorkspaceContext);\r\n            this.observe(this._entityWorkspaceContext.variantOptions, (options) => {\r\n                console.log('UMB_ENTITY_WORKSPACE_CONTEXT:variant options:', options)\r\n            })\r\n\r\n            this.observe(this._entityWorkspaceContext.variants, (variants) => {\r\n                console.log('UMB_ENTITY_WORKSPACE_CONTEXT:variants:', variants)\r\n            })\r\n\r\n            this._entityWorkspaceContext.propertyValueByAlias(\"contentBlocks\").then(x => {\r\n                this.observe(x, (contentBlocks) => {\r\n                    console.log('UMB_ENTITY_WORKSPACE_CONTEXT:contentBlocks:', contentBlocks)\r\n                })\r\n            })\r\n            this._entityWorkspaceContext.propertyValueByAlias(\"title\").then(x => {\r\n                this.observe(x, (title) => {\r\n                    console.log('UMB_ENTITY_WORKSPACE_CONTEXT:title:', title)\r\n                })\r\n            })\r\n        })\r\n    }\r\n\r\n    override async connectedCallback() {\r\n        super.connectedCallback();\r\n        this.#consumeContexts()\r\n\r\n        console.log('UMB_WORKSPACE_CONTEXT:contentBlocks', this._workspaceContext?.getPropertyValue<unknown>(\"contentBlocks\"))\r\n        console.log('UMB_WORKSPACE_CONTEXT:title', this._workspaceContext?.getPropertyValue<string>(\"title\"))\r\n        console.log('UMB_PROPERTY_DATASET_CONTEXT:variantId', this._propertyDatasetContext?.getVariantId())\r\n        console.log('UMB_PROPERTY_DATASET_CONTEXT:unique', this._propertyDatasetContext?.getUnique())\r\n        console.log('UMB_DOCUMENT_WORKSPACE_CONTEXT:collectionAlias:', this._documentWorkspaceContext?.getCollectionAlias())\r\n        console.log('UMB_DOCUMENT_WORKSPACE_CONTEXT:data:', this._documentWorkspaceContext?.getData())\r\n        console.log('UMB_DOCUMENT_WORKSPACE_CONTEXT:contentBlocks', this._documentWorkspaceContext?.getPropertyValue('contentBlocks'))\r\n        console.log('UMB_PROPERTY_CONTEXT:variantId:', this._propertyContext?.getVariantId())\r\n        console.log('UMB_PROPERTY_CONTEXT:getAlias:', this._propertyContext?.getAlias())\r\n        console.log('UMB_ENTITY_CONTEXT:unique:', this._entityContext?.getUnique())\r\n        console.log('UMB_ENTITY_WORKSPACE_CONTEXT:type:', this._entityWorkspaceContext?.getEntityType())\r\n        console.log('UMB_ENTITY_WORKSPACE_CONTEXT:unique:', this._entityWorkspaceContext?.getUnique())\r\n        console.log('UMB_ENTITY_WORKSPACE_CONTEXT:type2:', this._entityWorkspaceContext?.getEntityType())\r\n        console.log('UMB_ENTITY_WORKSPACE_CONTEXT:unique2:', this._entityWorkspaceContext?.getUnique())\r\n        await this._anchorsContext?.getContentBlockIds(this._nodeId ?? '', 'nl-NL')\r\n    }\r\n\r\n    render() {\r\n        return html`\r\n        <uui-box>    \r\n            <p>anchor tag editor</p>              \r\n        </uui-box>\r\n        <umb-debug visible></umb-debug>\r\n        `\r\n    }\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'anchor-tag-picker': AnchorTagPicker;\r\n    }\r\n}"],"names":["_AnchorTagPicker_instances","consumeContexts_fn","AnchorTagPicker","UmbElementMixin","LitElement","__privateAdd","UMB_ENTITY_CONTEXT","ctx","ANCHORS_MANAGEMENT_CONTEXT_TOKEN","instance","anchors","__privateMethod","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","html","UMB_WORKSPACE_CONTEXT","options","variants","UMB_PROPERTY_DATASET_CONTEXT","x","anchorLinks","UMB_DOCUMENT_WORKSPACE_CONTEXT","UMB_PROPERTY_CONTEXT","id","UMB_ENTITY_WORKSPACE_CONTEXT","contentBlocks","title","__decorateClass","property","state","customElement"],"mappings":"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"}